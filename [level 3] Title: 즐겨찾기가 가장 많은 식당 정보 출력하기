-- 튜플 비교
-- SELECT FOOD_TYPE, REST_ID, REST_NAME, FAVORITES
-- FROM REST_INFO 
-- WHERE (FOOD_TYPE, FAVORITES) IN (SELECT FOOD_TYPE, MAX(FAVORITES)
--                     FROM REST_INFO
--                     GROUP BY FOOD_TYPE)
-- ORDER BY FOOD_TYPE desc;

-- 인라인 뷰
SELECT ri.FOOD_TYPE, ri.REST_ID, ri.REST_NAME, ri.FAVORITES
FROM REST_INFO ri
JOIN(
        SELECT FOOD_TYPE, MAX(FAVORITES) AS max_favorites
        FROM REST_INFO
        GROUP BY FOOD_TYPE  
    )m
    ON ri.FOOD_TYPE = m.FOOD_TYPE
    AND ri.FAVORITES = m.max_favorites
ORDER BY ri.FOOD_TYPE desc;



